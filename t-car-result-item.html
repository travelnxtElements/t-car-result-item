<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../t-image/t-image.html">
<link rel="import" href="../t-text-container/travel-element-styles.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../t-shared-lib/t-fare-behavior.html">
<!--
A comment describing this element

Example:

    <my-elem></my-elem>

Example:

    <my-elem>
      <h2>Hello my-elem</h2>
    </my-elem>

@demo demo/index.html
-->
<dom-module id="t-car-result-item">
    <template>
        <style include="iron-flex"></style>
        <style include="travel-element-styles">
        :host {
            display: block;
            margin-top: 10px;
            border: solid black thin;
            padding: 5px;
        }
        
        .imageArea {
            width: 100%;
            height: 150px;
            margin: 10px 0 10px 0;
        }
        
        .imageArea t-image {
            width: 100%;
            height: 100%;
        }
        
        .logoArea {
            width: 50px;
            height: 20px;
            position: relative;
        }
        
        .logoArea t-image {
            width: 100%;
            height: 100%;
        }
        </style>
        <div class="imageArea">
            <t-image src="{{imageUrl}}"></t-image>
        </div>
        <div><b>{{name}}</b></div>
        <div>{{vehicleType}}</div>
        <div>{{location}}</div>
        <div class="logoArea">
            <t-image src="{{logo}}"></t-image>
        </div>
        <div>{{capacity}}</div>
        <div>{{baggage}}</div>
        <div>{{airConditioning}}</div>
        <div>{{transmission}}</div>
        <div>{{doors}}</div>

        <div>{{_getDisplayFare(_displayPrice.money.amount, itinerary.stayDuration.start.date, itinerary.stayDuration.end.date)}}</div>
    </template>
    <script>
    (function() {
        Polymer({
            is: 't-car-result-item',
            properties: {
                name: {
                    type: String,
                    value: ''
                },
                vehicleType: {
                    type: String,
                    value: ''
                },
                location: {
                    type: String,
                    value: ''
                },
                price: {
                    type: String,
                    value: ''
                },
                tag: {
                    type: String,
                    value: ''
                },
                imageUrl: {
                    type: String,
                    value: ''
                },
                itinerary: {
                    type: Object,
                    value: null,
                    observer: '_onItineraryUpdate'
                }
            },

            behaviors: [TravelNxt.Behaviors.FareBehavior],

            _onItineraryUpdate: function() {
                this._setItineraryProperties();
            },

            _setItineraryProperties: function() {
                if (!this.itinerary) {
                    return;
                }

                this.name = this.itinerary.name;
                this.vehicleType = this.itinerary.vehicleType;
                this.location = this.itinerary.pickupInfo.address;
                this.imageUrl = this.itinerary.heroImageUrl;
                this.logo = this.itinerary.brand.logo;

                this.capacity = this.itinerary.capacity;
                this.baggage = this.itinerary.baggage;
                this.airConditioning = this.itinerary.airConditioning;
                this.transmission = this.itinerary.transmission;
                this.doors = this.itinerary.doors;
                this._components = this.itinerary.fare.components;
            },

            _fareComponentsChanged: function(components) {
                this._components = components;
                var x = this._displayPrice;
            },

            _getDisplayFare: function(amount, checkIn, checkOut) {
                if (amount) {
                    return Math.ceil(amount / this._dateDiff(checkIn, checkOut));
                }
                return null;
            }
        });
    })();
    </script>
</dom-module>
