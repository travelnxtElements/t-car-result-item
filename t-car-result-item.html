<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../t-image/t-image.html">
<link rel="import" href="../t-button/t-button.html">
<link rel="import" href="../t-text-container/travel-element-styles.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../t-shared-lib/t-fare-behavior.html">
<!--
A comment describing this element

Example:

    <my-elem></my-elem>

Example:

    <my-elem>
      <h2>Hello my-elem</h2>
    </my-elem>

@demo demo/index.html
-->
<dom-module id="t-car-result-item">
    <template>
        <style include="iron-flex"></style>
        <style include="travel-element-styles">
        :host {
            display: block;
            margin-top: 10px;
            border: solid black thin;
            padding: 5px;
        }
        
        .imageArea {
            width: 100%;
            height: 150px;
            margin: 10px 0 10px 0;
        }
        
        .imageArea t-image {
            width: 100%;
            height: 100%;
        }
        
        .logoArea {
            width: 50px;
            height: 20px;
            position: relative;
        }
        
        .logoArea t-image {
            width: 100%;
            height: 100%;
        }
        </style>
        <div class="imageArea">
            <t-image src="{{itinerary.heroImageUrl}}"></t-image>
        </div>
        <div><b>{{itinerary.name}}</b></div>
        <div>{{itinerary.vehicleType}}</div>
        <div>{{itinerary.pickupInfo.address}}</div>
        <div class="logoArea">
            <t-image src="{{itinerary.brand.logo}}"></t-image>
        </div>
        <div>{{itinerary.capacity}}</div>
        <div>{{itinerary.baggage}}</div>
        <div>{{itinerary.airConditioning}}</div>
        <div>{{itinerary.transmission}}</div>
        <div>{{itinerary.doors}}</div>

        <div>{{_getDisplayFare(_displayPrice.money.amount, itinerary.stayDuration.start.date, itinerary.stayDuration.end.date)}}</div>
        <br>        
        <div><b>pick-up from</b></div>
        <div>[[itinerary.pickupInfo.address]]</div>
        <br>
        <div><b>drop-off to</b></div>
        <div>[[itinerary.dropoffInfo.address]]</div>

        <t-button id="search" class="primary row" on-click="_bookCar" type="button" label="book" /></t-button>
    </template>
    <script>
    (function() {
        Polymer({
            is: 't-car-result-item',

            properties: {
                price: {
                    type: String,
                    value: ''
                },
                itinerary: {
                    type: Object,
                    value: null,
                    observer: '_onItineraryUpdate'
                }
            },

            behaviors: [TravelNxt.Behaviors.FareBehavior],

            _onItineraryUpdate: function() {
                if (this.itinerary && this.itinerary.fare) {
                    this._components = this.itinerary.fare.components;
                }
            },

            _getDisplayFare: function(amount, checkIn, checkOut) {
                if (amount) {
                    return Math.ceil(amount / this._dateDiff(checkIn, checkOut));
                }
                return null;
            },

            _bookCar: function () {
                this.fire('book-car-itinerary', {
                    itineraryId: this.itinerary.id
                });
            }
        });
    })();
    </script>
</dom-module>
