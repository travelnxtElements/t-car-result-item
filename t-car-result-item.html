<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../t-image/t-image.html">
<link rel="import" href="../t-button/t-button.html">
<link rel="import" href="../t-text-container/travel-element-styles.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../t-shared-lib/t-fare-behavior.html">
<!--
A comment describing this element

Example:

    <my-elem></my-elem>

Example:

    <my-elem>
      <h2>Hello my-elem</h2>
    </my-elem>

@demo demo/index.html
-->
<dom-module id="t-car-result-item">
    <template>
        <style include="iron-flex"></style>
        <style include="travel-element-styles">
        :host {
            display: block;
            margin-top: 10px;
            border-bottom: solid black thin;
            padding: 5px;
        }
        
        .imageArea {
            width: 100%;
            height: 150px;
            padding: 10px 0 40px 0;
            margin-bottom: 20px;
            border-bottom: solid black thin;
        }
        
        .imageArea t-image {
            width: 100%;
            height: 100%;
        }
        
        .logoArea {
            width: 50px;
            height: 20px;
            position: relative;
        }
        
        .logoArea t-image {
            width: 100%;
            height: 100%;
        }
        </style>
        <template is="dom-if" if="[[isFirstItem]]">
            <div class="imageArea">
                <t-image src="{{itinerary.heroImageUrl}}"></t-image>
                <div>
                <b>{{itinerary.category}}</b>
                &emsp;&emsp;&emsp;&emsp;&emsp;
                <b>{{price}}</b></div>
            </div>
        </template>
        <br>
        <div><b>{{itinerary.name}}</b></div>
        <br>
        <div>{{itinerary.vehicleType}}</div>
        <div>{{itinerary.pickupInfo.address}}</div>
        <br>
        <div class="logoArea">
            <t-image src="{{itinerary.brand.logo}}"></t-image>
        </div>
        <div>{{itinerary.capacity}}</div>
        <div>{{itinerary.baggage}}</div>
        <div>{{itinerary.airConditioning}}</div>
        <div>{{itinerary.transmission}}</div>
        <div>{{itinerary.doors}}</div>
        <br>

        <div><b>pick-up from</b></div>
        <div>[[itinerary.pickupInfo.address]]</div>
        <br>
        <div><b>drop-off to</b></div>
        <div>[[itinerary.dropoffInfo.address]]</div>
        <br>

        <div>{{_getDisplayFare(_displayPrice.money.amount)}}</div>
        <br>

        <t-button id="search" class="primary row" on-click="_bookCar" type="button" label="book" /></t-button>

    </template>
    <script>
    (function() {
        Polymer({
            is: 't-car-result-item',

            properties: {
                showImage: {
                    type: Boolean,
                    value: false
                },

                price: {
                    type: String,
                    value: ''
                },
                currency: {
                    type: String,
                    value: 'USD'
                },
                bookPeriod: {
                    type: Number
                },
                itinerary: {
                    type: Object,
                    value: null
                }
            },

            behaviors: [TravelNxt.Behaviors.FareBehavior],

            observers: [
                '_onItineraryUpdate(itinerary, bookPeriod)'
            ],

            _onItineraryUpdate: function() {    
                if (this.itinerary && this.itinerary.fare) {
                    this._components = this.itinerary.fare.components;
                    this.isFirstItem = this.itinerary.isFirstItinerary;
                }
            },

            _getDisplayFare: function(amount) {
                if (amount) {
                    return this.currency + ' ' + Math.ceil(amount) + ' for ' + this.bookPeriod + ' days';
                }
                return null;
            },

            _bookCar: function () {
                this.fire('book-car-itinerary', {
                    itineraryId: this.itinerary.id
                });
            }
        });
    })();
    </script>
</dom-module>
